# ðŸ§© 3347: Maximum Frequency of an Element After Performing Operations II

- **Difficulty**: `Hard`
- **Tags / Topics**: `Array`, `Binary Search`, `Sliding Window`, `Sorting`, `Prefix Sum`
- **Link**: [Leetcode](https://leetcode.com/problems/maximum-frequency-of-an-element-after-performing-operations-ii/)

---

## ðŸ“œ Description

<p>You are given an integer array <code>nums</code> and two integers <code>k</code> and <code>numOperations</code>.</p>

<p>You must perform an <strong>operation</strong> <code>numOperations</code> times on <code>nums</code>, where in each operation you:</p>

<ul>
	<li>Select an index <code>i</code> that was <strong>not</strong> selected in any previous operations.</li>
	<li>Add an integer in the range <code>[-k, k]</code> to <code>nums[i]</code>.</li>
</ul>

<p>Return the <strong>maximum</strong> possible <span data-keyword="frequency-array">frequency</span> of any element in <code>nums</code> after performing the <strong>operations</strong>.</p>




## ðŸ§ª Examples



## ðŸ“Œ Constraints"
<ul>
	<li><code>1 &lt;= nums.length &lt;= 10<sup>5</sup></code></li>
	<li><code>1 &lt;= nums[i] &lt;= 10<sup>9</sup></code></li>
	<li><code>0 &lt;= k &lt;= 10<sup>9</sup></code></li>
	<li><code>0 &lt;= numOperations &lt;= nums.length</code></li>
</ul>



---
<!--- code section starts -->
## ðŸ§  Code



<details>
<summary>Click to read Python code</summary>

```python
class Solution:
    def maxFrequency(self, nums: List[int], k: int, numOperations: int) -> int:
        nums.sort()
        n = len(nums)
        res = 0

        fm = defaultdict(int)
        l, r = 0, 0
        for x in nums:
            while r < n and nums[r] <= x + k:
                fm[nums[r]] += 1
                r += 1
            while l < n and nums[l] < x - k:
                fm[nums[l]] -= 1
                l += 1

            mx_ops = r - l - fm[x]
            res = max(res, min(mx_ops, numOperations) + fm[x])

        l = 0
        for r in range(n):
            while l < n and nums[l] + (k * 2) < nums[r]:
                l += 1
            mx_ops = r - l + 1
            res = max(res, min(mx_ops, numOperations))

        return res

```

</details>
    

<!--- code section ends -->
