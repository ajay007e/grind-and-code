# ðŸ§© 3408: Design Task Manager

- **Difficulty**: `Medium`
- **Tags / Topics**: `Hash Table`, `Design`, `Heap (Priority Queue)`, `Ordered Set`
- **Link**: [Leetcode](https://leetcode.com/problems/design-task-manager/)

---

## ðŸ“œ Description

<p>There is a task management system that allows users to manage their tasks, each associated with a priority. The system should efficiently handle adding, modifying, executing, and removing tasks.</p>

<p>Implement the <code>TaskManager</code> class:</p>

<ul>
	<li>
	<p><code>TaskManager(vector&lt;vector&lt;int&gt;&gt;&amp; tasks)</code> initializes the task manager with a list of user-task-priority triples. Each element in the input list is of the form <code>[userId, taskId, priority]</code>, which adds a task to the specified user with the given priority.</p>
	</li>
	<li>
	<p><code>void add(int userId, int taskId, int priority)</code> adds a task with the specified <code>taskId</code> and <code>priority</code> to the user with <code>userId</code>. It is <strong>guaranteed</strong> that <code>taskId</code> does not <em>exist</em> in the system.</p>
	</li>
	<li>
	<p><code>void edit(int taskId, int newPriority)</code> updates the priority of the existing <code>taskId</code> to <code>newPriority</code>. It is <strong>guaranteed</strong> that <code>taskId</code> <em>exists</em> in the system.</p>
	</li>
	<li>
	<p><code>void rmv(int taskId)</code> removes the task identified by <code>taskId</code> from the system. It is <strong>guaranteed</strong> that <code>taskId</code> <em>exists</em> in the system.</p>
	</li>
	<li>
	<p><code>int execTop()</code> executes the task with the <strong>highest</strong> priority across all users. If there are multiple tasks with the same <strong>highest</strong> priority, execute the one with the highest <code>taskId</code>. After executing, the<strong> </strong><code>taskId</code><strong> </strong>is <strong>removed</strong> from the system. Return the <code>userId</code> associated with the executed task. If no tasks are available, return -1.</p>
	</li>
</ul>

<p><strong>Note</strong> that a user may be assigned multiple tasks.</p>




## ðŸ§ª Examples



## ðŸ“Œ Constraints"
<ul>
	<li><code>1 &lt;= tasks.length &lt;= 10<sup>5</sup></code></li>
	<li><code>0 &lt;= userId &lt;= 10<sup>5</sup></code></li>
	<li><code>0 &lt;= taskId &lt;= 10<sup>5</sup></code></li>
	<li><code>0 &lt;= priority &lt;= 10<sup>9</sup></code></li>
	<li><code>0 &lt;= newPriority &lt;= 10<sup>9</sup></code></li>
	<li>At most <code>2 * 10<sup>5</sup></code> calls will be made in <strong>total</strong> to <code>add</code>, <code>edit</code>, <code>rmv</code>, and <code>execTop</code> methods.</li>
	<li>The input is generated such that <code>taskId</code> will be valid.</li>
</ul>



---
<!--- code section starts -->
## ðŸ§  Code



<details>
<summary>Click to read Python code</summary>

```python
from dataclasses import dataclass

from sortedcontainers import SortedDict, SortedSet


@dataclass(frozen=True)
class Task:
    userId: int
    taskId: int
    priority: int

    def __lt__(self, other):
        if self.priority == other.priority:
            return self.taskId > other.taskId
        return self.priority > other.priority


class TaskManager:
    def __init__(self, tasks: list[list[int]]):
        # {taskId: Task}, keeps tasks sorted by taskId
        self.taskMap = SortedDict()
        self.taskSet = SortedSet()  # Stores tasks sorted by priority and taskId
        for task in tasks:
            self.add(task[0], task[1], task[2])

    def add(self, userId: int, taskId: int, priority: int) -> None:
        task = Task(userId, taskId, priority)
        self.taskMap[taskId] = task
        self.taskSet.add(task)

    def edit(self, taskId: int, newPriority: int) -> None:
        task = self.taskMap[taskId]
        self.taskSet.remove(task)
        editedTask = Task(task.userId, taskId, newPriority)
        self.taskSet.add(editedTask)
        self.taskMap[taskId] = editedTask

    def rmv(self, taskId: int) -> None:
        task = self.taskMap[taskId]
        self.taskSet.remove(task)
        del self.taskMap[taskId]

    def execTop(self):
        if not self.taskSet:
            return -1
        task = self.taskSet.pop(0)
        del self.taskMap[task.taskId]
        return task.userId

```

</details>
    

<!--- code section ends -->
